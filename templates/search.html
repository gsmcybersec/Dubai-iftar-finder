<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search Mosques ‚Äî UAE Iftar Finder</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root{--navy:#0a0f1e;--navy2:#111827;--navy3:#1e2a3a;--gold:#c9922a;--gold2:#e8b84b;--gold3:#fde68a;--cream:#fdf8f0;--white:#fff;--muted:#94a3b8;--border:rgba(201,146,42,0.2);--card-bg:#141c2e}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--navy);color:var(--white);min-height:100vh}
nav{position:sticky;top:0;z-index:100;background:rgba(10,15,30,0.95);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center}
.logo{display:flex;align-items:center;gap:.6rem;text-decoration:none}
.logo-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--gold),var(--gold2));border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.2rem}
.logo-text{font-family:'Playfair Display',serif;font-size:1.2rem;color:var(--white)}
.logo-text span{color:var(--gold2)}
.nav-links a{color:var(--muted);text-decoration:none;padding:.5rem 1rem;border-radius:8px;font-size:.9rem;transition:all .2s;margin-left:.25rem}
.nav-links a:hover{color:var(--white);background:rgba(255,255,255,.05)}
.nav-btn{background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--navy)!important;font-weight:600}

/* FILTER BAR */
.filter-bar{background:var(--navy2);border-bottom:1px solid var(--border);padding:1.5rem 2rem}
.filter-form{max-width:1100px;margin:0 auto;display:flex;gap:.75rem;flex-wrap:wrap;align-items:center}
.filter-input{flex:2;min-width:180px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:.75rem 1.1rem;color:var(--white);font-size:.9rem;font-family:'Plus Jakarta Sans',sans-serif;outline:none;transition:border .2s}
.filter-input::placeholder{color:rgba(255,255,255,.3)}
.filter-input:focus{border-color:var(--gold)}
.filter-select{flex:1;min-width:130px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:.75rem 1rem;color:var(--white);font-size:.85rem;font-family:'Plus Jakarta Sans',sans-serif;outline:none;cursor:pointer}
.filter-select option{background:var(--navy2);color:var(--white)}
.btn-search{padding:.75rem 1.5rem;background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--navy);border:none;border-radius:10px;font-weight:700;cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif;white-space:nowrap}
.btn-clear{padding:.75rem 1rem;background:rgba(255,255,255,.06);color:var(--muted);border:1px solid rgba(255,255,255,.1);border-radius:10px;font-size:.85rem;cursor:pointer;text-decoration:none}

/* FOOD CHIPS */
.chips-wrap{max-width:1100px;margin:.75rem auto 0;display:flex;gap:.5rem;flex-wrap:wrap}
.chip{padding:.3rem .9rem;border-radius:999px;font-size:.8rem;cursor:pointer;text-decoration:none;border:1px solid rgba(255,255,255,.12);color:var(--muted);transition:all .15s;display:inline-flex;align-items:center;gap:.3rem}
.chip:hover,.chip.active{background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--navy);border-color:var(--gold);font-weight:600}

/* MAIN */
main{max-width:1140px;margin:0 auto;padding:2rem 1.5rem}
.results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:.75rem}
.results-count{font-size:.95rem;color:var(--muted)}
.results-count strong{color:var(--gold2);font-size:1.25rem}
.add-link{color:var(--gold2);font-weight:600;font-size:.875rem;text-decoration:none;padding:.4rem .9rem;border:1px solid var(--border);border-radius:8px;transition:all .2s}
.add-link:hover{background:rgba(201,146,42,0.1)}

/* GRID */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.25rem}
.mosque-card{background:var(--card-bg);border:1px solid var(--border);border-radius:16px;padding:1.5rem;transition:all .25s;text-decoration:none;color:inherit;display:block;position:relative;overflow:hidden}
.mosque-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--gold),var(--gold2));opacity:0;transition:opacity .25s}
.mosque-card:hover{transform:translateY(-3px);box-shadow:0 12px 40px rgba(0,0,0,.5);border-color:rgba(201,146,42,0.4)}
.mosque-card:hover::before{opacity:1}
.card-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.75rem;gap:.5rem}
.mosque-name{font-family:'Playfair Display',serif;font-size:1.15rem;color:var(--white);font-weight:600;line-height:1.25}
.mosque-arabic{font-size:.9rem;color:var(--gold2);direction:rtl;margin-top:.2rem;opacity:.8}
.verified-badge{background:rgba(16,185,129,.15);color:#6ee7b7;border:1px solid rgba(16,185,129,.3);font-size:.7rem;padding:.2rem .6rem;border-radius:999px;white-space:nowrap;flex-shrink:0}
.mosque-area{display:flex;align-items:center;gap:.4rem;color:var(--muted);font-size:.85rem;margin-bottom:.6rem}
.food-tags{display:flex;gap:.35rem;flex-wrap:wrap;margin:.5rem 0}
.food-tag{background:rgba(201,146,42,0.12);color:var(--gold2);font-size:.72rem;padding:.2rem .6rem;border-radius:999px;border:1px solid rgba(201,146,42,.25)}
.mosque-notes{font-size:.83rem;color:rgba(148,163,184,.8);background:rgba(255,255,255,.03);padding:.6rem .8rem;border-radius:8px;border:1px solid rgba(255,255,255,.05);margin-top:.6rem;line-height:1.5}
.mosque-footer{margin-top:1rem;padding-top:.85rem;border-top:1px solid rgba(255,255,255,.06);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.5rem}
.mosque-metas{display:flex;gap:1rem;flex-wrap:wrap}
.mosque-meta{font-size:.78rem;color:var(--muted);display:flex;align-items:center;gap:.3rem}
.whatsapp-btn{display:inline-flex;align-items:center;gap:.3rem;background:rgba(37,211,102,.12);color:#25d366;border:1px solid rgba(37,211,102,.25);padding:.3rem .75rem;border-radius:8px;font-size:.78rem;font-weight:600;text-decoration:none;transition:all .2s}
.whatsapp-btn:hover{background:rgba(37,211,102,.22)}

/* EMPTY */
.empty-state{text-align:center;padding:5rem 2rem;color:var(--muted)}
.empty-icon{font-size:4rem;margin-bottom:1rem}
.empty-state h3{font-size:1.3rem;color:var(--white);margin-bottom:.5rem}
.empty-state a{color:var(--gold2);text-decoration:none;font-weight:600}

/* ADD CTA */
.add-cta{background:var(--card-bg);border:1px solid var(--border);border-radius:16px;padding:2.5rem;text-align:center;margin-top:3rem}
.add-cta h3{font-family:'Playfair Display',serif;font-size:1.5rem;margin-bottom:.5rem}
.add-cta p{color:var(--muted);font-size:.9rem;margin-bottom:1.5rem}
.btn-add{display:inline-block;padding:.8rem 2rem;background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--navy);border-radius:10px;font-weight:700;text-decoration:none}

footer{background:var(--navy2);border-top:1px solid var(--border);padding:1.5rem;text-align:center}
.footer-inner{max-width:800px;margin:0 auto}
.footer-name{font-family:'Playfair Display',serif;color:var(--gold2);font-size:1rem;margin-bottom:.4rem}
.footer-links{display:flex;justify-content:center;gap:1.5rem;flex-wrap:wrap;margin-bottom:.5rem}
.footer-links a{color:var(--muted);text-decoration:none;font-size:.85rem}
.footer-links a:hover{color:var(--gold2)}
.footer-copy{font-size:.78rem;color:rgba(148,163,184,.4)}

@media(max-width:640px){
  nav{padding:.75rem 1rem}
  .nav-links a:not(.nav-btn){display:none}
  .filter-bar{padding:1rem}
  .filter-input,.filter-select,.btn-search{width:100%}
  main{padding:1.5rem 1rem}
  .grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<nav>
  <a href="/" class="logo">
    <div class="logo-icon">üïå</div>
    <span class="logo-text">UAE <span>Iftar</span> Finder</span>
  </a>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/add" class="nav-btn">+ Add Mosque</a>
  </div>
</nav>

<div class="filter-bar">
  <form action="/search" method="get" class="filter-form">
    <input class="filter-input" type="text" name="q" placeholder="üîç Mosque name, area, food..." value="{{ query }}">
    <select class="filter-select" name="city">
      <option value="">üèôÔ∏è All Emirates</option>
      {% for c in cities %}
      <option value="{{ c.city }}" {% if c.city==city %}selected{% endif %}>{{ c.city }}</option>
      {% endfor %}
    </select>
    <select class="filter-select" name="food">
      <option value="">üçΩÔ∏è All Food</option>
      {% for ft in food_types %}
      <option value="{{ ft }}" {% if ft==food %}selected{% endif %}>{{ ft }}</option>
      {% endfor %}
    </select>
    <select class="filter-select" name="iftar_time">
      <option value="">‚è∞ Any Time</option>
      <option value="Maghrib" {% if iftar_time=='Maghrib' %}selected{% endif %}>Maghrib</option>
      <option value="After Asr" {% if iftar_time=='After Asr' %}selected{% endif %}>After Asr (Early)</option>
      <option value="After Maghrib" {% if iftar_time=='After Maghrib' %}selected{% endif %}>After Maghrib</option>
    </select>
    <button type="submit" class="btn-search">Search ‚Üí</button>
    {% if query or city or food or iftar_time %}
    <a href="/search" class="btn-clear">‚úï Clear</a>
    {% endif %}
  </form>
  <div class="chips-wrap">
    {% for ft in food_types %}
    <a href="/search?food={{ ft }}{% if city %}&city={{ city }}{% endif %}"
       class="chip {% if food==ft %}active{% endif %}">üçΩÔ∏è {{ ft }}</a>
    {% endfor %}
  </div>
</div>

<main>
  <div class="results-header">
    <div class="results-count">
      <strong>{{ mosques|length }}</strong> mosque{% if mosques|length!=1 %}s{% endif %}
      {% if city %} in <em>{{ city }}</em>{% endif %}
      {% if food %} ¬∑ <em>{{ food }}</em>{% endif %}
      {% if query %} ¬∑ "<em>{{ query }}</em>"{% endif %}
    </div>
    <a href="/add" class="add-link">+ Add Missing Mosque</a>
  </div>

  {% if mosques %}
  <div class="grid">
    {% for m in mosques %}
    <a href="/mosque/{{ m.id }}" class="mosque-card">
      <div class="card-top">
        <div>
          <div class="mosque-name">{{ m.name }}</div>
          {% if m.arabic_name %}<div class="mosque-arabic">{{ m.arabic_name }}</div>{% endif %}
        </div>
        {% if m.verified %}<span class="verified-badge">‚úì Verified</span>{% endif %}
      </div>
      <div class="mosque-area">üìç {{ m.area }}, {{ m.city }}</div>
      {% if m.food_type %}
      <div class="food-tags">
        {% for ft in m.food_type.split(',') %}
        <span class="food-tag">{{ ft.strip() }}</span>
        {% endfor %}
      </div>
      {% endif %}
      {% if m.notes %}
      <div class="mosque-notes">{{ m.notes[:130] }}{% if m.notes|length>130 %}‚Ä¶{% endif %}</div>
      {% endif %}
      <div class="mosque-footer">
        <div class="mosque-metas">
          <span class="mosque-meta">üåô {{ m.iftar_time or 'Maghrib' }}</span>
          {% if m.capacity %}<span class="mosque-meta">üë• ~{{ m.capacity }}</span>{% endif %}
          {% if m.contact %}<span class="mosque-meta">üìû {{ m.contact }}</span>{% endif %}
        </div>
        <a class="whatsapp-btn" onclick="event.preventDefault();shareWhatsApp('{{ m.name }}','{{ m.city }}','{{ m.area }}')">
          üì≤ Share
        </a>
      </div>
    </a>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">
    <div class="empty-icon">üïå</div>
    <h3>No mosques found</h3>
    <p style="margin-top:.5rem">Try a different search or <a href="/add">add this mosque</a> to help others!</p>
  </div>
  {% endif %}

  <div class="add-cta">
    <h3>Know a Mosque Offering Iftar?</h3>
    <p>Help the UAE community ‚Äî add it to our directory in seconds.</p>
    <a href="/add" class="btn-add">+ Add Mosque</a>
  </div>
</main>

<footer>
  <div class="footer-inner">
    <div class="footer-name">Built by Muhammad Farooque üåô</div>
    <div class="footer-links">
      <a href="/">Home</a>
      <a href="/search">Browse</a>
      <a href="/add">Add Mosque</a>
      <a href="mailto:technogsmfarooq@gmail.com">üìß Contact</a>
    </div>
    <div class="footer-copy">UAE Iftar Finder ¬∑ Ramadan Kareem üåô</div>
  </div>
</footer>

<script>
function shareWhatsApp(name, city, area) {
  const url = window.location.origin + window.location.pathname;
  const text = `üïå *${name}*\nüìç ${area}, ${city}\nüåô Offering free Iftar meals this Ramadan!\n\nFind more UAE Iftar mosques: ${url}`;
  window.open('https://wa.me/?text=' + encodeURIComponent(text), '_blank');
}
</script>
</body>
</html>
